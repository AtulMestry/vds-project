<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/px-polymer-font-awesome/px-polymer-font-awesome.html">
<link rel="import" href="px-path-guide-styles.html">

<dom-module id="px-path-guide">
  <template>
    <style include="px-path-guide-styles"></style>
    <div id="main" draggable="true">
      <template id="steps" is="dom-repeat" items="[[pathState.steps]]">
        <div id="step-item-[[item.id]]" class="step-connector" on-click="itemClick">
          <div class$="step-icon [[getStepState(item)]]"></div>
          <iron-icon class$="[[getStepState(item)]]" icon$="fa:[[getIcon(item)]]"></iron-icon>
          <div class$="step-label [[getStepState(item)]]">[[item.label]]</div>
        </div>
      </template>
    </div>
  </template>
  <script>
    Polymer({
      is: 'px-path-guide',
      properties: {
        completedStepIcon: 'fa-check',
        currentStepIcon: 'fa-circle',
        pathState: {
          type: Object
        },
        stepClickEventName: ''
      },

      getIcon: function(item) {
        if (item.completed) {
          return this.completedStepIcon;
        }
        else if (item.current) {
          return this.currentStepIcon;
        }
        return "";
      },

      getStepState: function(item) {
        var classes = '';
        if (item.completed) {
          classes += 'completed';
        }
        if (item.current) {
          classes += 'current';
        }
        return classes;
      },

      itemClick: function(event) {
        var stepId = event.currentTarget.id.substr(10);
        var stepClickEvent =
          new Event(this.stepClickEventName,
            {"bubbles": true, "cancelable": false}
          );
        stepClickEvent.payload = { id : stepId };
        window.dispatchEvent(stepClickEvent);
      }

    });
  </script>
</dom-module>
